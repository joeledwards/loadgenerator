<project name="LoadGenerator" basedir="." >

    <property name="src.dir"     			value="src"/>
	<property name="lib.dir"     			value="lib"/>
	<property name="build.dir"     			value="build"/>
	<property name="bin.dir"     			value="bin"/>
	<property name="LoadGenerator-1.0.dir" 	value="LoadGenerator-1.0"/>
    <property name="main-class"  value="com.awebstorm.loadgenerator.robot.TestFile"/>
	<property name="version"	value="1.0" />

    <path id="classpath">
        <fileset dir="${lib.dir}" includes="**/*.jar"/>
    </path>

    <target name="clean">
    	<delete dir="${build.dir}" />
    	<delete dir="${bin.dir}" />
    	<delete dir="${LoadGenerator-1.0.dir}" />
    </target>

    <target name="compile">
    	<mkdir dir="${build.dir}"/>
        <javac srcdir="${src.dir}" destdir="${build.dir}" classpathref="classpath"/>
        <copy todir="${build.dir}">
            <fileset dir="${src.dir}" excludes="**/*.java"/>
        </copy>
    </target>

    <target name="jar" depends="compile">
        <jar destfile="${build.dir}/${ant.project.name}.jar" basedir="${build.dir}">
        	 <manifest>
        	 	<attribute name="Main-Class" value="${main-class}" />
        	 	<attribute name="Class-Path" value="../${lib.dir}/htmlunit-2.1.jar 
        	 			../${lib.dir}/jaxen-1.1.1.jar 
        	 			../${lib.dir}/jbehave-1.0.1.jar 
        	 			../${lib.dir}/js-1.7R1.jar 
        	 			../${lib.dir}/junit-3.8.2.jar 
        	 			../${lib.dir}/log4j-1.2.14.jar 
        	 			../${lib.dir}/mail-1.4.jar 
        	 			../${lib.dir}/nekohtml-1.9.7.jar 
        	 			../${lib.dir}/oro-2.0.6.jar 
        	 			../${lib.dir}/pdfbox-0.7.3-dev-log4j-20060612.jar 
        	 			../${lib.dir}/sac-1.3.jar 
        	 			../${lib.dir}/xalan-2.7.0.jar 
        	 			../${lib.dir}/xercesImpl-2.8.1.jar 
        	 			../${lib.dir}/xml-apis-1.0.b2.jar 
        	 			../${lib.dir}/xmlParserAPIs-2.6.2.jar 
        	 			../${lib.dir}/groovy-all-1.5.4.jar 
        	 			../${lib.dir}/activation-1.1.jar 
        	 	 		../${lib.dir}/commons-codec-1.3.jar 	
        	 	 		../${lib.dir}/commons-collections-3.2.jar 
        	 	 		../${lib.dir}/commons-httpclient-3.1.jar 
        	 	 		../${lib.dir}/commons-io-1.4.jar 
        	 	 		../${lib.dir}/commons-lang-2.4.jar 
        	 	 		../${lib.dir}/commons-logging-1.1.1.jar 
        	 	 		../${lib.dir}/cssparser-0.9.5.jar " />
         		<section name="LoadGenerator">
        		  <attribute name="Implementation-Title" value="LoadGenerator" /> 
        		  <attribute name="Implementation-Version" value="${version}" /> 
        		  <attribute name="Implementation-Vendor" value="CustomerCentrix" /> 
        		  </section>
        	  </manifest>
        </jar>
    </target>
    	
	<target name="dist" depends="jar">
    	<mkdir dir="${LoadGenerator-1.0.dir}"/>
		<mkdir dir="${LoadGenerator-1.0.dir}/${bin.dir}"/>
		<mkdir dir="${LoadGenerator-1.0.dir}/${lib.dir}"/>
        <copy todir="${LoadGenerator-1.0.dir}">
            <fileset dir="./" includes="**/*.bat" />
        </copy>
        <copy todir="${LoadGenerator-1.0.dir}">
            <fileset dir="./" includes="**/log4j.properties" />
        </copy>
        <copy todir="${LoadGenerator-1.0.dir}/${bin.dir}">
            <fileset dir="${build.dir}" includes="**/LoadGenerator.properties" />
        </copy>
        <copy todir="${LoadGenerator-1.0.dir}">
            <fileset dir="./" includes="**/*.xml" excludes="**/Build.xml"/>
        </copy>
        <copy todir="${LoadGenerator-1.0.dir}/${lib.dir}">
            <fileset dir="${lib.dir}" />
        </copy>
        <copy todir="${LoadGenerator-1.0.dir}/${bin.dir}">
            <fileset dir="${build.dir}" includes="**/*.jar"/>
        </copy>
    </target>	
	
    <target name="run" depends="dist">
        <java fork="true" classname="${main-class}">
            <classpath>
                 <path refid="classpath"/>
                 <path location="${LoadGenerator-1.0.dir}/${bin.dir}/${ant.project.name}.jar"/>
             </classpath>        
        </java>
    </target>

    <target name="clean-build" depends="clean,jar"/>

    <target name="main" depends="clean,run"/>

</project>